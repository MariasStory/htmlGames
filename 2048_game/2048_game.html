<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Galactic 2048 - The Cosmic Puzzle Adventure</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        />
        <style>
            @keyframes tile-appear {
                0% {
                    transform: scale(0.5);
                    opacity: 0;
                }
                100% {
                    transform: scale(1);
                    opacity: 1;
                }
            }

            @keyframes tile-merge {
                0% {
                    transform: scale(1);
                }
                50% {
                    transform: scale(1.2);
                }
                100% {
                    transform: scale(1);
                }
            }

            @keyframes star-pulse {
                0% {
                    transform: scale(1);
                }
                50% {
                    transform: scale(1.3);
                }
                100% {
                    transform: scale(1);
                }
            }

            .tile-new {
                animation: tile-appear 0.2s ease-out;
            }

            .tile-merged {
                animation: tile-merge 0.2s ease-out;
            }

            .star-pulse {
                animation: star-pulse 1s infinite;
            }

            .game-container {
                perspective: 1000px;
            }

            .game-board {
                transform-style: preserve-3d;
                transition: transform 0.3s;
            }

            .game-board:hover {
                transform: rotateX(5deg) rotateY(5deg);
            }

            .tile {
                transition: all 0.1s;
                box-shadow: 0 0 30px rgba(255, 255, 255, 0.1);
            }

            .confetti {
                position: absolute;
                width: 10px;
                height: 10px;
                background-color: #f0f;
                border-radius: 50%;
                pointer-events: none;
            }
        </style>
    </head>
    <body
        class="bg-gray-900 text-white min-h-screen flex flex-col items-center justify-center p-4 font-sans"
    >
        <div class="max-w-4xl w-full">
            <header class="flex flex-col items-center mb-8">
                <h1
                    class="text-5xl font-bold bg-gradient-to-r from-purple-500 via-pink-500 to-yellow-500 bg-clip-text text-transparent mb-2"
                >
                    Galactic 2048
                </h1>
                <p class="text-gray-400 text-center">
                    Combine tiles to reach 2048 and beyond! Explore the cosmic
                    levels!
                </p>
            </header>

            <div
                class="flex flex-col md:flex-row gap-8 items-center md:items-start justify-center"
            >
                <div class="game-container">
                    <div class="flex justify-between items-center mb-4">
                        <div
                            class="bg-gray-800 rounded-lg p-3 flex items-center"
                        >
                            <span class="text-yellow-400 mr-2"
                                ><i class="fas fa-trophy"></i
                            ></span>
                            <span id="score" class="font-bold">0</span>
                        </div>
                        <div
                            class="bg-gray-800 rounded-lg p-3 flex items-center"
                        >
                            <span class="text-blue-400 mr-2"
                                ><i class="fas fa-layer-group"></i
                            ></span>
                            <span id="level" class="font-bold">1</span>
                        </div>
                        <div
                            class="bg-gray-800 rounded-lg p-3 flex items-center"
                        >
                            <span class="text-yellow-400 mr-2"
                                ><i class="fas fa-star"></i
                            ></span>
                            <span id="stars" class="font-bold">0</span>
                        </div>
                    </div>

                    <div class="relative">
                        <div
                            class="game-board bg-gray-800 rounded-xl p-4 shadow-2xl"
                        >
                            <div
                                id="board"
                                class="grid grid-cols-4 gap-3 w-64 h-64"
                            >
                                <!-- Tiles will be generated here -->
                            </div>
                        </div>
                        <div
                            id="game-over"
                            class="hidden absolute inset-0 bg-black bg-opacity-70 rounded-xl flex flex-col items-center justify-center"
                        >
                            <h2 class="text-2xl font-bold mb-4">Game Over!</h2>
                            <button
                                id="restart-btn"
                                class="bg-purple-600 hover:bg-purple-700 px-6 py-2 rounded-full font-bold transition"
                            >
                                Play Again
                            </button>
                        </div>
                        <div
                            id="level-up"
                            class="hidden absolute inset-0 bg-black bg-opacity-70 rounded-xl flex flex-col items-center justify-center"
                        >
                            <h2 class="text-2xl font-bold mb-2">
                                Level Complete!
                            </h2>
                            <p class="mb-4">
                                You earned
                                <span id="earned-stars" class="text-yellow-400"
                                    >3</span
                                >
                                <i class="fas fa-star text-yellow-400"></i>
                            </p>
                            <button
                                id="next-level-btn"
                                class="bg-green-600 hover:bg-green-700 px-6 py-2 rounded-full font-bold transition"
                            >
                                Next Level
                            </button>
                        </div>
                    </div>

                    <div class="mt-6 flex justify-center gap-4">
                        <button
                            id="new-game-btn"
                            class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-full font-bold transition"
                        >
                            <i class="fas fa-plus mr-1"></i> New Game
                        </button>
                        <button
                            id="undo-btn"
                            class="bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-full font-bold transition"
                        >
                            <i class="fas fa-undo mr-1"></i> Undo
                        </button>
                    </div>
                </div>

                <div
                    class="bg-gray-800 rounded-xl p-6 shadow-xl w-full md:w-64"
                >
                    <h3
                        class="text-xl font-bold mb-4 border-b border-gray-700 pb-2"
                    >
                        How to Play
                    </h3>
                    <ul class="space-y-3 text-gray-300">
                        <li class="flex items-start">
                            <span class="text-yellow-400 mr-2"
                                ><i class="fas fa-arrow-up"></i
                            ></span>
                            <span>Use arrow keys or swipe to move tiles</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-yellow-400 mr-2"
                                ><i class="fas fa-plus"></i
                            ></span>
                            <span
                                >Combine matching tiles to double their
                                value</span
                            >
                        </li>
                        <li class="flex items-start">
                            <span class="text-yellow-400 mr-2"
                                ><i class="fas fa-star"></i
                            ></span>
                            <span>Earn stars by reaching milestones</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-yellow-400 mr-2"
                                ><i class="fas fa-layer-group"></i
                            ></span>
                            <span
                                >Complete levels to unlock new challenges</span
                            >
                        </li>
                    </ul>

                    <h3
                        class="text-xl font-bold mt-6 mb-4 border-b border-gray-700 pb-2"
                    >
                        Level Goals
                    </h3>
                    <div id="level-goals" class="text-gray-300">
                        <div class="flex items-center mb-2">
                            <span
                                class="w-6 h-6 bg-purple-600 rounded-full flex items-center justify-center mr-2"
                                >1</span
                            >
                            <span
                                >Reach
                                <span class="font-bold">512</span> tile</span
                            >
                        </div>
                    </div>

                    <div class="mt-6 pt-4 border-t border-gray-700">
                        <div class="flex items-center justify-between">
                            <span class="text-gray-400">Progress:</span>
                            <span id="progress-text" class="font-bold">0%</span>
                        </div>
                        <div class="w-full bg-gray-700 rounded-full h-2.5 mt-2">
                            <div
                                id="progress-bar"
                                class="bg-gradient-to-r from-purple-500 to-pink-500 h-2.5 rounded-full"
                                style="width: 0%"
                            ></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer class="mt-12 text-center text-gray-500 text-sm">
            <p>
                Use keyboard arrows or swipe to play. Combine tiles to reach the
                next level!
            </p>
        </footer>

        <script>
            document.addEventListener("DOMContentLoaded", () => {
                // Game state
                let board = [];
                let score = 0;
                let bestScore = localStorage.getItem("bestScore") || 0;
                let stars = parseInt(localStorage.getItem("stars")) || 0;
                let level = parseInt(localStorage.getItem("level")) || 1;
                let previousBoards = [];
                let gameWon = false;
                let gameOver = false;

                // Level requirements (target tile value to complete level)
                const levelRequirements = [
                    512, // Level 1
                    1024, // Level 2
                    2048, // Level 3
                    4096, // Level 4
                    8192, // Level 5
                ];

                // DOM elements
                const boardElement = document.getElementById("board");
                const scoreElement = document.getElementById("score");
                const starsElement = document.getElementById("stars");
                const levelElement = document.getElementById("level");
                const gameOverElement = document.getElementById("game-over");
                const levelUpElement = document.getElementById("level-up");
                const newGameBtn = document.getElementById("new-game-btn");
                const restartBtn = document.getElementById("restart-btn");
                const nextLevelBtn = document.getElementById("next-level-btn");
                const undoBtn = document.getElementById("undo-btn");
                const levelGoalsElement =
                    document.getElementById("level-goals");
                const progressBar = document.getElementById("progress-bar");
                const progressText = document.getElementById("progress-text");
                const earnedStarsElement =
                    document.getElementById("earned-stars");

                // Initialize the game
                initGame();

                // Event listeners
                document.addEventListener("keydown", handleKeyPress);
                newGameBtn.addEventListener("click", initGame);
                restartBtn.addEventListener("click", initGame);
                nextLevelBtn.addEventListener("click", nextLevel);
                undoBtn.addEventListener("click", undoMove);

                // Touch events for mobile
                let touchStartX, touchStartY, touchEndX, touchEndY;

                document.addEventListener(
                    "touchstart",
                    (e) => {
                        e.preventDefault(); // Disables scrolling and zooming
                        touchStartX = e.changedTouches[0].screenX;
                        touchStartY = e.changedTouches[0].screenY;
                    },
                    false,
                );

                document.addEventListener(
                    "touchmove",
                    (e) => {
                        e.preventDefault(); // Disables scrolling and zooming
                    },
                    false,
                );

                document.addEventListener(
                    "touchend",
                    (e) => {
                        e.preventDefault(); // Disables scrolling and zooming
                        touchEndX = e.changedTouches[0].screenX;
                        touchEndY = e.changedTouches[0].screenY;
                        handleSwipe();
                    },
                    false,
                );

                function handleSwipe() {
                    if (gameOver) return;

                    const dx = touchEndX - touchStartX;
                    const dy = touchEndY - touchStartY;

                    if (Math.abs(dx) > Math.abs(dy)) {
                        if (dx > 0) moveTiles("right");
                        else moveTiles("left");
                    } else {
                        if (dy > 0) moveTiles("down");
                        else moveTiles("up");
                    }
                }

                function handleKeyPress(e) {
                    if (gameOver) return;

                    switch (e.key) {
                        case "ArrowUp":
                            moveTiles("up");
                            break;
                        case "ArrowDown":
                            moveTiles("down");
                            break;
                        case "ArrowLeft":
                            moveTiles("left");
                            break;
                        case "ArrowRight":
                            moveTiles("right");
                            break;
                    }
                }

                function initGame() {
                    // Reset game state
                    board = Array(4)
                        .fill()
                        .map(() => Array(4).fill(0));
                    score = 0;
                    gameWon = false;
                    gameOver = false;

                    // Hide game over/level up screens
                    gameOverElement.classList.add("hidden");
                    levelUpElement.classList.add("hidden");

                    // Update UI
                    updateScore();
                    updateStars();
                    updateLevel();
                    updateLevelGoals();

                    // Add initial tiles
                    addRandomTile();
                    addRandomTile();

                    // Render the board
                    renderBoard();

                    // Reset previous boards for undo
                    previousBoards = [];
                }

                function nextLevel() {
                    level++;
                    if (level > levelRequirements.length)
                        level = levelRequirements.length;
                    localStorage.setItem("level", level);
                    levelUpElement.classList.add("hidden");
                    initGame();
                }

                function updateLevelGoals() {
                    levelGoalsElement.innerHTML = "";

                    for (let i = 0; i < levelRequirements.length; i++) {
                        const goalElement = document.createElement("div");
                        goalElement.className = "flex items-center mb-2";

                        const levelNumber = document.createElement("span");
                        levelNumber.className = `w-6 h-6 rounded-full flex items-center justify-center mr-2 ${
                            i + 1 === level ? "bg-purple-600" : "bg-gray-700"
                        }`;
                        levelNumber.textContent = i + 1;

                        const goalText = document.createElement("span");
                        goalText.innerHTML = `Reach <span class="font-bold">${levelRequirements[i]}</span> tile`;

                        if (i + 1 < level) {
                            const checkIcon = document.createElement("span");
                            checkIcon.className = "ml-2 text-green-400";
                            checkIcon.innerHTML =
                                '<i class="fas fa-check"></i>';
                            goalText.appendChild(checkIcon);
                        }

                        goalElement.appendChild(levelNumber);
                        goalElement.appendChild(goalText);

                        if (i + 1 === level) {
                            goalElement.classList.add("font-bold");
                        }

                        levelGoalsElement.appendChild(goalElement);
                    }
                }

                function renderBoard() {
                    boardElement.innerHTML = "";

                    // Calculate current progress toward level goal
                    let maxTile = 0;
                    let progress = 0;

                    for (let row = 0; row < 4; row++) {
                        for (let col = 0; col < 4; col++) {
                            const value = board[row][col];
                            if (value > maxTile) maxTile = value;

                            const tile = document.createElement("div");
                            tile.className = `tile w-14 h-14 rounded-md flex items-center justify-center font-bold text-lg ${
                                value === 0
                                    ? "bg-gray-700"
                                    : getTileColor(value)
                            }`;

                            if (value > 0) {
                                tile.textContent = value;
                            }

                            boardElement.appendChild(tile);
                        }
                    }

                    // Calculate progress toward level goal
                    if (level <= levelRequirements.length) {
                        const currentGoal = levelRequirements[level - 1];
                        progress = Math.min(100, (maxTile / currentGoal) * 100);
                    }

                    progressBar.style.width = `${progress}%`;
                    progressText.textContent = `${Math.round(progress)}%`;

                    // Check for level completion
                    if (
                        !gameWon &&
                        level <= levelRequirements.length &&
                        maxTile >= levelRequirements[level - 1]
                    ) {
                        levelComplete();
                    }
                }

                function getTileColor(value) {
                    const colors = {
                        2: "bg-gray-100 text-gray-800",
                        4: "bg-gray-200 text-gray-800",
                        8: "bg-yellow-300 text-gray-800",
                        16: "bg-yellow-400 text-gray-800",
                        32: "bg-orange-400 text-white",
                        64: "bg-orange-500 text-white",
                        128: "bg-yellow-500 text-white",
                        256: "bg-yellow-600 text-white",
                        512: "bg-purple-400 text-white",
                        1024: "bg-purple-500 text-white",
                        2048: "bg-pink-500 text-white",
                        4096: "bg-red-500 text-white",
                        8192: "bg-indigo-600 text-white",
                    };

                    return colors[value] || "bg-black text-white";
                }

                function addRandomTile() {
                    const emptyCells = [];

                    for (let row = 0; row < 4; row++) {
                        for (let col = 0; col < 4; col++) {
                            if (board[row][col] === 0) {
                                emptyCells.push({ row, col });
                            }
                        }
                    }

                    if (emptyCells.length > 0) {
                        const { row, col } =
                            emptyCells[
                                Math.floor(Math.random() * emptyCells.length)
                            ];
                        board[row][col] = Math.random() < 0.9 ? 2 : 4;

                        // Add animation class to the new tile
                        const tileIndex = row * 4 + col;
                        setTimeout(() => {
                            const tiles =
                                boardElement.querySelectorAll(".tile");
                            if (tiles[tileIndex]) {
                                tiles[tileIndex].classList.add("tile-new");
                                setTimeout(
                                    () =>
                                        tiles[tileIndex].classList.remove(
                                            "tile-new",
                                        ),
                                    200,
                                );
                            }
                        }, 10);
                    }
                }

                function moveTiles(direction) {
                    if (gameOver) return;

                    // Save current board state for undo
                    const previousBoard = JSON.parse(JSON.stringify(board));
                    const previousScore = score;

                    let moved = false;

                    // Process the move based on direction
                    switch (direction) {
                        case "up":
                            moved = moveUp();
                            break;
                        case "down":
                            moved = moveDown();
                            break;
                        case "left":
                            moved = moveLeft();
                            break;
                        case "right":
                            moved = moveRight();
                            break;
                    }

                    if (moved) {
                        // Save previous state for undo
                        previousBoards.push({
                            board: previousBoard,
                            score: previousScore,
                        });
                        if (previousBoards.length > 5) previousBoards.shift();

                        addRandomTile();
                        updateScore();
                        renderBoard();

                        if (isGameOver()) {
                            gameOver = true;
                            gameOverElement.classList.remove("hidden");
                        }
                    }
                }

                function moveUp() {
                    let moved = false;

                    for (let col = 0; col < 4; col++) {
                        for (let row = 1; row < 4; row++) {
                            if (board[row][col] !== 0) {
                                let currentRow = row;

                                while (
                                    currentRow > 0 &&
                                    board[currentRow - 1][col] === 0
                                ) {
                                    board[currentRow - 1][col] =
                                        board[currentRow][col];
                                    board[currentRow][col] = 0;
                                    currentRow--;
                                    moved = true;
                                }

                                if (
                                    currentRow > 0 &&
                                    board[currentRow - 1][col] ===
                                        board[currentRow][col]
                                ) {
                                    board[currentRow - 1][col] *= 2;
                                    score += board[currentRow - 1][col];
                                    board[currentRow][col] = 0;
                                    moved = true;

                                    // Add merge animation
                                    const tileIndex =
                                        (currentRow - 1) * 4 + col;
                                    setTimeout(() => {
                                        const tiles =
                                            boardElement.querySelectorAll(
                                                ".tile",
                                            );
                                        if (tiles[tileIndex]) {
                                            tiles[tileIndex].classList.add(
                                                "tile-merged",
                                            );
                                            setTimeout(
                                                () =>
                                                    tiles[
                                                        tileIndex
                                                    ].classList.remove(
                                                        "tile-merged",
                                                    ),
                                                200,
                                            );
                                        }
                                    }, 10);
                                }
                            }
                        }
                    }

                    return moved;
                }

                function moveDown() {
                    let moved = false;

                    for (let col = 0; col < 4; col++) {
                        for (let row = 2; row >= 0; row--) {
                            if (board[row][col] !== 0) {
                                let currentRow = row;

                                while (
                                    currentRow < 3 &&
                                    board[currentRow + 1][col] === 0
                                ) {
                                    board[currentRow + 1][col] =
                                        board[currentRow][col];
                                    board[currentRow][col] = 0;
                                    currentRow++;
                                    moved = true;
                                }

                                if (
                                    currentRow < 3 &&
                                    board[currentRow + 1][col] ===
                                        board[currentRow][col]
                                ) {
                                    board[currentRow + 1][col] *= 2;
                                    score += board[currentRow + 1][col];
                                    board[currentRow][col] = 0;
                                    moved = true;

                                    // Add merge animation
                                    const tileIndex =
                                        (currentRow + 1) * 4 + col;
                                    setTimeout(() => {
                                        const tiles =
                                            boardElement.querySelectorAll(
                                                ".tile",
                                            );
                                        if (tiles[tileIndex]) {
                                            tiles[tileIndex].classList.add(
                                                "tile-merged",
                                            );
                                            setTimeout(
                                                () =>
                                                    tiles[
                                                        tileIndex
                                                    ].classList.remove(
                                                        "tile-merged",
                                                    ),
                                                200,
                                            );
                                        }
                                    }, 10);
                                }
                            }
                        }
                    }

                    return moved;
                }

                function moveLeft() {
                    let moved = false;

                    for (let row = 0; row < 4; row++) {
                        for (let col = 1; col < 4; col++) {
                            if (board[row][col] !== 0) {
                                let currentCol = col;

                                while (
                                    currentCol > 0 &&
                                    board[row][currentCol - 1] === 0
                                ) {
                                    board[row][currentCol - 1] =
                                        board[row][currentCol];
                                    board[row][currentCol] = 0;
                                    currentCol--;
                                    moved = true;
                                }

                                if (
                                    currentCol > 0 &&
                                    board[row][currentCol - 1] ===
                                        board[row][currentCol]
                                ) {
                                    board[row][currentCol - 1] *= 2;
                                    score += board[row][currentCol - 1];
                                    board[row][currentCol] = 0;
                                    moved = true;

                                    // Add merge animation
                                    const tileIndex =
                                        row * 4 + (currentCol - 1);
                                    setTimeout(() => {
                                        const tiles =
                                            boardElement.querySelectorAll(
                                                ".tile",
                                            );
                                        if (tiles[tileIndex]) {
                                            tiles[tileIndex].classList.add(
                                                "tile-merged",
                                            );
                                            setTimeout(
                                                () =>
                                                    tiles[
                                                        tileIndex
                                                    ].classList.remove(
                                                        "tile-merged",
                                                    ),
                                                200,
                                            );
                                        }
                                    }, 10);
                                }
                            }
                        }
                    }

                    return moved;
                }

                function moveRight() {
                    let moved = false;

                    for (let row = 0; row < 4; row++) {
                        for (let col = 2; col >= 0; col--) {
                            if (board[row][col] !== 0) {
                                let currentCol = col;

                                while (
                                    currentCol < 3 &&
                                    board[row][currentCol + 1] === 0
                                ) {
                                    board[row][currentCol + 1] =
                                        board[row][currentCol];
                                    board[row][currentCol] = 0;
                                    currentCol++;
                                    moved = true;
                                }

                                if (
                                    currentCol < 3 &&
                                    board[row][currentCol + 1] ===
                                        board[row][currentCol]
                                ) {
                                    board[row][currentCol + 1] *= 2;
                                    score += board[row][currentCol + 1];
                                    board[row][currentCol] = 0;
                                    moved = true;

                                    // Add merge animation
                                    const tileIndex =
                                        row * 4 + (currentCol + 1);
                                    setTimeout(() => {
                                        const tiles =
                                            boardElement.querySelectorAll(
                                                ".tile",
                                            );
                                        if (tiles[tileIndex]) {
                                            tiles[tileIndex].classList.add(
                                                "tile-merged",
                                            );
                                            setTimeout(
                                                () =>
                                                    tiles[
                                                        tileIndex
                                                    ].classList.remove(
                                                        "tile-merged",
                                                    ),
                                                200,
                                            );
                                        }
                                    }, 10);
                                }
                            }
                        }
                    }

                    return moved;
                }

                function isGameOver() {
                    // Check if there are any empty cells
                    for (let row = 0; row < 4; row++) {
                        for (let col = 0; col < 4; col++) {
                            if (board[row][col] === 0) {
                                return false;
                            }
                        }
                    }

                    // Check if there are any possible merges
                    for (let row = 0; row < 4; row++) {
                        for (let col = 0; col < 4; col++) {
                            const value = board[row][col];

                            // Check right
                            if (col < 3 && board[row][col + 1] === value) {
                                return false;
                            }

                            // Check down
                            if (row < 3 && board[row + 1][col] === value) {
                                return false;
                            }
                        }
                    }

                    return true;
                }

                function updateScore() {
                    scoreElement.textContent = score;

                    if (score > bestScore) {
                        bestScore = score;
                        localStorage.setItem("bestScore", bestScore);
                    }
                }

                function updateStars() {
                    starsElement.textContent = stars;
                }

                function updateLevel() {
                    levelElement.textContent = level;
                }

                function levelComplete() {
                    gameWon = true;

                    // Calculate stars earned (1-3 based on performance)
                    const starsEarned = Math.min(
                        3,
                        Math.floor(
                            score / (levelRequirements[level - 1] * 0.5),
                        ),
                    );
                    stars += starsEarned;
                    localStorage.setItem("stars", stars);

                    // Update UI
                    earnedStarsElement.textContent = starsEarned;
                    levelUpElement.classList.remove("hidden");
                    updateStars();

                    // Create confetti effect
                    createConfetti();
                }

                function createConfetti() {
                    const colors = [
                        "#ff0000",
                        "#00ff00",
                        "#0000ff",
                        "#ffff00",
                        "#ff00ff",
                        "#00ffff",
                    ];

                    for (let i = 0; i < 50; i++) {
                        const confetti = document.createElement("div");
                        confetti.className = "confetti";
                        confetti.style.backgroundColor =
                            colors[Math.floor(Math.random() * colors.length)];
                        confetti.style.left = `${Math.random() * 100}%`;
                        confetti.style.top = `${Math.random() * 100}%`;
                        confetti.style.transform = `rotate(${Math.random() * 360}deg)`;

                        levelUpElement.appendChild(confetti);

                        // Animation
                        const animation = confetti.animate(
                            [
                                {
                                    transform: `translate(0, 0) rotate(0deg)`,
                                    opacity: 1,
                                },
                                {
                                    transform: `translate(${Math.random() * 200 - 100}px, ${Math.random() * 200 + 100}px) rotate(${Math.random() * 360}deg)`,
                                    opacity: 0,
                                },
                            ],
                            {
                                duration: 1000 + Math.random() * 1000,
                                easing: "cubic-bezier(0,0.2,0.8,1)",
                            },
                        );

                        animation.onfinish = () => confetti.remove();
                    }
                }

                function undoMove() {
                    if (previousBoards.length > 0 && !gameOver) {
                        const previousState = previousBoards.pop();
                        board = previousState.board;
                        score = previousState.score;

                        updateScore();
                        renderBoard();
                    }
                }
            });
        </script>
    </body>
</html>
